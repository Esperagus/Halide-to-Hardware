notifications:
  email: false
dist: trusty
sudo: false
language: c
compiler:
  # Comment out for now to keep build matrix small
  #- clang
  - gcc
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.9
      - libedit-dev
      - libpng-dev
      - graphviz
env:
  # Configurations
  #
  # Each line in the ``env`` section represents a set of environment
  # variables passed to a build configuration
  #
  # Test a mix of llvm versions, a mix of build systems, and a mix of shared vs static library
  # Don't build as a static library with cmake. It risks exceeding the travis memory limit.
  - LLVM_VERSION=5.0.0 BUILD_SYSTEM=MAKE CXX_=g++-4.9 CC_=gcc-4.9

cache: apt

# Note the commands below are written assuming Ubuntu 12.04LTS
before_install:
  # set variables necessary for halide
  - source test/scripts/before_install_travis.sh
  # set envirnoment variables specific to this repo
  - export TEST_HALIDE_GEN=true

install:
  # install framework specific to halide
  - test/scripts/install_travis.sh  
  # compile coreir
  - git clone -b dev https://github.com/rdaly525/coreir.git
  # - make -C coreir all

script:
  # - test/scripts/build_travis.sh
  - mkdir lib
  - touch lib/libHalide.a
  - echo "hi" > lib/libHalide.a

before_deploy:
  #- git config --local user.name "jeffsetter"
  #- git config --local user.email "setter@stanford.edu"
  #- git tag "$(date +'%Y%m%d%H%M%S')-$(git log --format=%h -1)"
  - tar -zcvf lib/libHalide.tgz lib/libHalide.a
  #- echo $TRAVIS_DEPLOY_KEY > travis_key_file
  #- head -c10 travis_key_file
  #- RAW_TRAVIS_DEPLOY_KEY=`base64 --decode travis_key_file`
  #- echo $RAW_TRAVIS_DEPLOY_KEY | head -c10

deploy:
  provider: releases
  user:
    secure: "KIPnem6CokYXt33MBtoWfsffFIfppH+uVR82tUeGPQCXoiDw3tLhqj6emHPkQoVqb4xpbyk+ZmrHnuodjJICX/fSgUvUN2tZthZaLRzYSURb51yW8sXvfdz5yPzK1BcGnqUnIcPFV8RT/JnW/oHagGRGu1jD6zmk0SSkSmRwYKX3Gf72cHRbdjptHPIvYDU4HxL5pQ/1FXLKyy8dFNwjSDhsO4rs0tXrIbg1fxGfngbCXB0/+M1zX3QNr9DH4jdArbcqwG87i+GU5FI/UGFYwqhmZB0PE4aidRGxRQ+kFDZMccvzS/bjlCMWNuoXpM5fq+TA/A+UX/ggeejNjuA40HqQG4BWu6QccKeCu5Ykd/ZDQPfG5ocjO3P7BvGHlrU+a4W3fVBK0uBQeSusVIrFRJDsW5YuZUaXiYo4TGigeSeuK8l61C1GpXcvpVcyFbxZ5qSYK5M3WWy5B+2uxB+96azHShpCnyb5QAFaGM1ywwW0LZAhW0zYZLSJmNojadsSUanzCsFQ3449Sub6QHC9//5Jqt2XBz87bVfTS8xB9MZpnRiQGRNwRnyXAuNJVHKMlQPIVFUNRjIgbabwiyqwJs/C8wkAy+BMd6opJK3WsM9hkMCC4AKyG7dry0WAUyxO1GF7SaTUl10L4xsBy5QwVTqjxmjNiFULiiuQwBPZYQY="
  password:
    secure: "G4eigdjmMjIHTgshSTmJdWxIlTwaPJ6Cj8RFyBqn3bhDM5ZenMVgZGeV9eQVK5q6Z02qd33sfNKS/ZLIWRT/R/yYfrc3FLD2Cghe62oXt828BkVMA7AE0jye7AY2KNAbEPHJVTYh5slTS+mJ9uED+Rk48F36jQfdzWfobMwvnmFqKuQwJ1Z+OzLnGiusF7JU1JtXrKwhvzpwk83MLe5KhGeNwwKbxfdt9ktkxSpLFV7f+S4/5XQa5JJ6OxrH8b7vXWPorpP6mNwuQix3HsEvMBiEZl169w25bUnWtHzXWwBYnKgV6wtRx71j2M0ptUZeGP4SY4D8kjwlni8pvphur4tesguLeFLzuPzKPDGkP0FbqKeZTS6dgao6Fe2bMDRwWXHG1lrgcAqfgHpNO9bRe/eS7XO8JJm1d6Z/nPWSobJAzx0JFM3GzCaLpf3ePeIVrMZ/xp/1k70SY7U/CzpF0R3HooZJrkHuZWD3IJrNCvPseo1J3CQcMyuVxdyQk+GfZm3FZ8kWnWYcm2MvP1dmoK1vNiTNItum8S174INVagK5O2v73ogCMixhYYw8okS9hynWnS4+yi82Z267bGfmbIZZP0VKXDxm3MlUDX328r6YRsUE/y2k4BjfLrRoAY0TIxrcIOpuufzitaZ/4UP4jjTZNzRwLHoYZKZ0P2FnBUY="
  file: lib/libHalie.tgz
  skip_cleanup: true
  on:
    tags: true
    
    